<!-- <p>
  chat works!
</p>
<div *ngFor="let message of messages">
  <p>{{message}}</p>
</div>


<input [(ngModel)]="message" (keyup)="$event.keyCode == 13 && sendMessage()" />
<button (click)="sendMessage()">Send</button>
 -->
<div class="container-fluid">
  <div class="row">
    <div class="col-lg-4">
      <div class="card mb-3">
        <div class="card-header"><i class="fa fa-users"></i> Clients</div>
        <div class="card-body">
          <div class="panel panel-primary">
            <div class="panel-body" id="rooms">
              <ul class="rooms">
                <div *ngFor="let client of clients">
                  <li class="left clearfix" >
                    <a class="nav-link">
                    <div class="chat-body clearfix">
                      <div class="header">
                        <a class="btn btn-outline-secondary" (click)="joinConversation(client.id)"><strong class="primary-font">{{client.firstName + ' ' + client.lastName}}</strong></a>
                      </div>
                    </div>
                    </a>
                  </li>
                </div>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-8">
      <div class="card mb-3">
        <div class="card-header"><i class="fa fa-comments-o"></i> Conversation</div>
        <div class="card-body">
          <div class="panel panel-primary">
            <!-- <div class="panel-heading"><span class="glyphicon glyphicon-comment"></span> Chat</div> -->
            <div class="panel-body" id="chat">
              <ul class="chat">
                <div *ngFor="let message of messages">
                  <div *ngIf="message.user_id == cookieService.get('UserID'); else clientsChat">
                    <li class="right clearfix">
                    <span class="chat-img pull-right">
                      <img src="http://placehold.it/50/FA6F57/fff&text=ME" alt="User Avatar" class="img-circle" />
                    </span>
                      <div class="chat-body clearfix">
                        <div class="header">
                          <small class=" text-muted"><span class="glyphicon glyphicon-time"></span>{{message.time | timeAgo}}</small>
                          <strong class="pull-right primary-font">{{message.user_name}}</strong>
                        </div>
                        <p>
                          {{message.message}}
                        </p>
                      </div>
                    </li>
                  </div>
                <ng-template #clientsChat >
                  <li class="left clearfix">
                    <span class="chat-img pull-left">
                      <img src="http://placehold.it/50/55C1E7/fff&text=U" alt="User Avatar" class="img-circle" />
                    </span>
                    <div class="chat-body clearfix">
                      <div class="header">
                        <strong class="primary-font">{{message.user_name}}</strong>
                        <small class="pull-right text-muted"><span class="glyphicon glyphicon-time"></span>{{ message.time  | timeAgo}}</small>
                      </div>
                      <p>
                        {{message.message}}
                      </p>
                    </div>
                  </li>
                </ng-template>
                </div>
              </ul>
            </div>
            <div class="panel-footer">
              <div class="input-group">
                <input id="btn-input" type="text" class="form-control input-sm" placeholder="Type your message here..." [(ngModel)]="message" (keyup)="$event.keyCode == 13 && sendMessage()" />
                <span class="input-group-btn">
                <button class="btn btn-warning btn-sm" id="btn-chat" (click)="sendMessage()">Send</button>
              </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
